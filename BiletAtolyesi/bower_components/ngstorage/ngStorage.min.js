(function(n,t){"use strict";typeof define=="function"&&define.amd?define(["angular"],t):n.hasOwnProperty("angular")?t(n.angular):typeof exports=="object"&&(module.exports=t(require("angular")))})(this,function(n){"use strict";function t(t){return function(){var i="ngStorage-",u,r;this.setKeyPrefix=function(n){if(typeof n!="string")throw new TypeError("[ngStorage] - "+t+"Provider.setKeyPrefix() expects a String.");i=n};u=n.toJson;r=n.fromJson;this.setSerializer=function(n){if(typeof n!="function")throw new TypeError("[ngStorage] - "+t+"Provider.setSerializer expects a function.");u=n};this.setDeserializer=function(n){if(typeof n!="function")throw new TypeError("[ngStorage] - "+t+"Provider.setDeserializer expects a function.");r=n};this.get=function(n){return r(window[t].getItem(i+n))};this.set=function(n,r){return window[t].setItem(i+n,u(r))};this.$get=["$rootScope","$window","$log","$timeout","$document",function(f,e,o,s,h){function p(n){var t,i;try{t=e[n]}catch(r){t=!1}if(t&&n==="localStorage"){i="__"+Math.round(Math.random()*1e7);try{localStorage.setItem(i,i);localStorage.removeItem(i)}catch(r){t=!1}}return t}var a=i.length,l=p(t)||(o.warn("This browser does not support Web Storage!"),{setItem:n.noop,getItem:n.noop,removeItem:n.noop}),c={$default:function(t){for(var i in t)n.isDefined(c[i])||(c[i]=n.copy(t[i]));return c.$sync(),c},$reset:function(n){for(var t in c)"$"===t[0]||delete c[t]&&l.removeItem(i+t);return c.$default(n)},$sync:function(){for(var t=0,u=l.length,n;t<u;t++)(n=l.key(t))&&i===n.slice(0,a)&&(c[n.slice(a)]=r(l.getItem(n)))},$apply:function(){var t,r;if(y=null,!n.equals(c,v)){t=n.copy(v);n.forEach(c,function(r,f){n.isDefined(r)&&"$"!==f[0]&&(l.setItem(i+f,u(r)),delete t[f])});for(r in t)l.removeItem(i+r);v=n.copy(c)}}},v,y;return c.$sync(),v=n.copy(c),f.$watch(function(){y||(y=s(c.$apply,100,!1))}),e.addEventListener&&e.addEventListener("storage",function(t){if(t.key){var u=h[0];u.hasFocus&&u.hasFocus()||i!==t.key.slice(0,a)||(t.newValue?c[t.key.slice(a)]=r(t.newValue):delete c[t.key.slice(a)],v=n.copy(c),f.$apply())}}),e.addEventListener&&e.addEventListener("beforeunload",function(){c.$apply()}),c}]}}return n=n&&n.module?n:window.angular,n.module("ngStorage",[]).provider("$localStorage",t("localStorage")).provider("$sessionStorage",t("sessionStorage"))});
//# sourceMappingURL=ngStorage.min.js.map
